# Быстрый старт: Нейросеть для распознавания 5-значных капч

Этот документ содержит инструкции по быстрому запуску проекта для распознавания 5-значных цифровых капч.

## 1. Установка зависимостей

Перед началом работы установите необходимые зависимости:

```bash
pip install -r requirements.txt
```

## 2. Структура проекта

Проект имеет следующую структуру:

```
├── dataset/               # Директория для хранения датасета
│   ├── train/            # Обучающая выборка (80%)
│   ├── validation/       # Валидационная выборка (10%)
│   └── test/             # Тестовая выборка (10%)
├── src/                  # Исходный код
│   ├── data_generator.py # Генерация датасета
│   ├── preprocessing.py  # Предобработка изображений
│   ├── model.py          # Архитектура нейросети
│   ├── train.py          # Обучение модели
│   ├── inference.py      # Инференс модели
│   └── run_pipeline.py   # Запуск полного пайплайна
├── models/               # Сохраненные модели
└── results/              # Результаты оценки модели
```

## 3. Полный пайплайн за один шаг

Для запуска полного пайплайна (генерация датасета, обучение, оценка) выполните команду:

```bash
python src/run_pipeline.py --run_all --num_samples 10000 --epochs 50 --augmentation
```

Эта команда:

1. Сгенерирует 10,000 изображений капч
2. Разделит их на обучающую, валидационную и тестовую выборки
3. Обучит модель с применением аугментаций
4. Оценит качество модели на тестовой выборке

## 4. Пошаговое выполнение

Если вы хотите выполнить каждый шаг отдельно:

### 4.1. Генерация датасета

```bash
python src/data_generator.py --num_samples 10000 --output_dir dataset
```

### 4.2. Обучение модели

```bash
python src/train.py --dataset_dir dataset --model_dir models --epochs 50 --batch_size 32 --augmentation
```

### 4.3. Оценка модели

```bash
python src/inference.py --mode evaluate --model_path models/best_model.h5 --test_dir dataset/test
```

### 4.4. Распознавание одного изображения

```bash
python src/inference.py --mode predict --model_path models/best_model.h5 --image_path path/to/captcha.png
```

## 5. Советы по оптимизации

- Для ускорения обучения используйте GPU, если доступен
- Для повышения точности увеличьте размер датасета и количество эпох
- Для улучшения скорости инференса используйте оттенки серого (--grayscale)
- Для дополнительной информации о подготовке датасета см. файл `dataset_preparation_guide.md`
- Для дополнительных примеров использования см. файл `examples.md`

## 6. Параметры командной строки

### 6.1. Генерация датасета (data_generator.py)

- `--num_samples`: Количество изображений для генерации
- `--output_dir`: Директория для сохранения датасета
- `--train_ratio`: Доля обучающей выборки (по умолчанию 0.8)
- `--val_ratio`: Доля валидационной выборки (по умолчанию 0.1)
- `--test_ratio`: Доля тестовой выборки (по умолчанию 0.1)

### 6.2. Обучение модели (train.py)

- `--dataset_dir`: Директория с датасетом
- `--model_dir`: Директория для сохранения моделей
- `--epochs`: Количество эпох обучения
- `--batch_size`: Размер батча
- `--grayscale`: Использовать оттенки серого вместо RGB
- `--augmentation`: Применять аугментации к обучающему датасету
- `--load_model`: Путь к существующей модели для продолжения обучения
- `--evaluate`: Оценить модель на тестовом датасете после обучения

### 6.3. Инференс (inference.py)

- `--mode`: Режим работы (predict или evaluate)
- `--model_path`: Путь к файлу модели
- `--image_path`: Путь к изображению для распознавания (для режима predict)
- `--test_dir`: Директория с тестовыми данными (для режима evaluate)
- `--output_dir`: Директория для сохранения результатов (для режима evaluate)
- `--grayscale`: Использовать оттенки серого вместо RGB
