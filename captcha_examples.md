# Примеры капч и процесс их распознавания

В этом документе приведены примеры капч, которые может распознавать наша нейросеть, и описан процесс их распознавания.

## 1. Примеры капч

Ниже приведены примеры 5-значных цифровых капч с различными вариациями:

### 1.1. Стандартные капчи

Стандартные капчи имеют следующие характеристики:

- Фон цвета около #759da3 (голубовато-серый)
- Цифры цвета около #1a2432 (темно-синий)
- Размер 100x40 пикселей
- 5 цифр от 0 до 9

```
12345  - Пример стандартной капчи без шума
98765  - Пример стандартной капчи без шума
```

### 1.2. Капчи с шумом

Капчи с шумом имеют дополнительные элементы, затрудняющие распознавание:

- Точки и линии случайного цвета
- Размытие
- Искажения цифр

```
56789  - Пример капчи с точками и линиями
24680  - Пример капчи с размытием
```

### 1.3. Капчи с искажениями

Капчи с искажениями имеют геометрические трансформации:

- Повороты цифр
- Искажения перспективы
- Различные размеры шрифта

```
13579  - Пример капчи с поворотом цифр
02468  - Пример капчи с искажением перспективы
```

## 2. Процесс распознавания

### 2.1. Предобработка изображения

1. **Загрузка изображения**

   - Чтение изображения с помощью OpenCV или PIL
   - Изменение размера до 100x40 пикселей

2. **Нормализация**
   - Преобразование в оттенки серого (опционально)
   - Нормализация значений пикселей в диапазон [0, 1]

### 2.2. Прохождение через нейросеть

1. **Сверточные слои**

   - Извлечение признаков из изображения
   - Применение фильтров для выделения контуров, форм и текстур

2. **Полносвязные слои**

   - Анализ извлеченных признаков
   - Классификация цифр на каждой из 5 позиций

3. **Выходные слои**
   - 5 отдельных softmax-слоев (по одному на каждую позицию)
   - Каждый слой выдает вероятности для цифр от 0 до 9

### 2.3. Постобработка результатов

1. **Определение наиболее вероятных цифр**

   - Выбор цифры с наибольшей вероятностью для каждой позиции

2. **Формирование итогового результата**

   - Объединение 5 цифр в одну строку

3. **Оценка уверенности**
   - Вычисление уверенности для каждой цифры
   - Определение общей уверенности для всей капчи

## 3. Визуализация процесса распознавания

Процесс распознавания капчи можно визуализировать следующим образом:

```
Входное изображение: [Изображение капчи 12345]

Предобработка: [Нормализованное изображение]

Активации сверточных слоев: [Визуализация активаций]

Выходные вероятности:
Позиция 1: [0: 0.01, 1: 0.95, 2: 0.02, ...]
Позиция 2: [0: 0.02, 1: 0.01, 2: 0.94, ...]
Позиция 3: [0: 0.01, 1: 0.01, 2: 0.01, 3: 0.95, ...]
Позиция 4: [0: 0.01, 1: 0.01, 2: 0.01, 3: 0.01, 4: 0.94, ...]
Позиция 5: [0: 0.01, 1: 0.01, 2: 0.01, 3: 0.01, 4: 0.01, 5: 0.93, ...]

Распознанный результат: 12345
Уверенность: 94.2%
Время инференса: 0.05 секунд
```

## 4. Сложные случаи распознавания

### 4.1. Слипшиеся цифры

Когда цифры перекрываются или касаются друг друга, распознавание затрудняется. Наша модель обучена на различных вариациях расположения цифр, что позволяет ей справляться с такими случаями.

### 4.2. Сильные искажения

При сильных искажениях или очень низком контрасте точность распознавания может снижаться. В таких случаях может потребоваться дополнительная предобработка изображения или дообучение модели на сложных примерах.

### 4.3. Нестандартные шрифты

Если капча использует нестандартные шрифты, не представленные в обучающей выборке, точность распознавания может снижаться. Для решения этой проблемы рекомендуется дообучить модель на примерах с такими шрифтами.

## 5. Советы по улучшению распознавания

1. **Увеличение разнообразия обучающей выборки**

   - Добавление примеров с различными шрифтами
   - Добавление примеров с различными искажениями
   - Добавление примеров с различными уровнями шума

2. **Оптимизация предобработки**

   - Экспериментирование с различными методами нормализации
   - Применение адаптивных фильтров для улучшения контраста

3. **Настройка архитектуры модели**
   - Увеличение или уменьшение количества слоев
   - Изменение количества фильтров в сверточных слоях
   - Экспериментирование с различными функциями активации
